# Code Review Guidelines

Personal guidelines for reviewing pull requests.

Also reference @~/workspace/configs/ai/AGENTS.md for general coding principles.

## Core Philosophy

- Focus on configuration patterns, clarity, and meaningful tests
- Provide thorough comments that guide authors to better solutions
- Link to standard documentation instead of giving too many details in comments

## Signature Concerns

### Configuration Patterns (Optify)

- **Improper config structure**: "Please see https://github.com/juharris/optify for fundamentals about configuration driven development and how to use Optify."
- **Git-based config preference**: "Cloud configurations outside of Git are terrible: https://github.com/juharris/optify?tab=readme-ov-file#ethos"

### Clarity and Documentation

- **Missing "why"**: "Why? The 'Why is this change necessary?' in the pull request description still doesn't explain why, just further elaborates what is being done. Please explain the reasoning behind the change."
- **Comments after code**: "Let's put instructional comments before code and configurations to explain what we're looking at before trying to read the line; otherwise, we see some confusing code and waste time thinking about it before seeing the explanation. It's much easier to be informed first."

### Testing Philosophy

Avoid redundant tests that look like they are generated by AI.
Try to re-use existing tests instead of creating new ones that are very similar to existing tests, but just change a few lines.

### Code Quality

- **Unnecessary complexity**: Question trim(), extra checks, mutex without explanation

## Voice and Style

**Typical comment structure:**
- Start with the issue and get to the actionable point quickly, then explain why. Example: "We don't need this line. See the comment on line 18."
- Use suggestion blocks extensively for concrete fixes
- Link to documentation frequently (example: internal docs and optify repo)
- Ask clarifying questions.

**Signature phrases:**
- "Let's..." - when suggesting changes ("Let's add docs here", "Let's use a set")
- "I'd rather..." - for preferences ("I'd rather be explicit", "I'd rather not change logic")
- "Please see..." - when pointing to documentation
- "I think..." - when questioning ("I think we should still assert something")
- "Fair enough" / "All good" - when accepting explanations

**Softening language:**
Never say "you" because it sounds like an accusation or attack, even for a compliment.
Use "we", "us", and "let's" to create a collaborative tone as we work as a team.

- "I don't think we need..." / "I don't think these tests are really necessary"
- "Maybe it would be better..." / "Could we..."
- "I guess..." when deferring to author's judgment

# Ruby

## Type Checking

Prefer `# typed: strict` at the top of files.
Using `strict` instead of `true` helps enforce full proper typing and checks in a few places such as for instance variables of classes.
See https://sorbet.org/docs/static for details.
Question changes that reduce type strictness without a clear reason because it's easy to reduce the strictness and often tempting for AI to get lazy and reduce strictness.
Then people will inevitably make changes that will make it even harder to increase strictness later.
